<form>
  <label>crt.sh</label>
  <description>Discovers certificates by searching all of the publicly known Certificate Transparency (CT) logs. (Site: https://crt.sh/, Rate Limit: None)</description>
  <search id="crtsh_no_wildcard_base" depends="$no_wildcard_panel$">
    <query>| crtsh $ioc$</query>
    <earliest>-15m</earliest>
    <latest>now</latest>
  </search>
  <search id="crtsh_wildcard_base" depends="$wildcard_panel$">
    <query>| crtsh wildcard $ioc$</query>
    <earliest>-15m</earliest>
    <latest>now</latest>
  </search>
  <fieldset submitButton="true">
    <input type="text" token="ioc">
      <label>Domain (+)</label>
    </input>
    <input type="dropdown" token="wildcard">
      <label>Wildcard (%.DOMAIN)</label>
      <choice value="yes">Yes</choice>
      <choice value="no">No</choice>
      <initialValue>no</initialValue>
      <change>
        <condition value="yes">
          <set token="wildcard_panel"></set>
          <unset token="no_wildcard_panel"></unset>
        </condition>
        <condition value="no">
          <unset token="wildcard_panel"></unset>
          <set token="no_wildcard_panel"></set>
        </condition>
      </change>
    </input>
  </fieldset>
  <row>
    <panel depends="$wildcard_panel$">
      <title>Results - Wildcard</title>
      <table>
        <search base="crtsh_wildcard_base">
          <query>| fillnull value="-" 
| search NOT "issuer ca id"="-" 
| dedup "issuer ca id" "issuer name" "name value" "min cert id" "min entry timestamp" "not before" "not after"
| table "issuer ca id" "issuer name" "name value" "min cert id" "min entry timestamp" "not before" "not after" 
| sort - "min cert id"</query>
        </search>
        <option name="count">10</option>
        <option name="drilldown">none</option>
        <option name="refresh.display">preview</option>
        <option name="rowNumbers">false</option>
        <option name="wrap">true</option>
      </table>
    </panel>
  </row>
  <row>
    <panel depends="$wildcard_panel$">
      <title>Results - Invalid</title>
      <table>
        <search base="crtsh_wildcard_base">
          <query>| dedup invalid 
| table invalid
| sort invalid</query>
        </search>
        <option name="count">10</option>
        <option name="drilldown">none</option>
        <option name="refresh.display">preview</option>
        <option name="rowNumbers">false</option>
        <option name="wrap">true</option>
      </table>
    </panel>
    <panel depends="$wildcard_panel$">
      <title>Results - No Data</title>
      <table>
        <search base="crtsh_wildcard_base">
          <query>| dedup "no data"
| table "no data"
| sort "no data"</query>
        </search>
        <option name="count">10</option>
        <option name="drilldown">none</option>
        <option name="refresh.display">preview</option>
        <option name="rowNumbers">false</option>
        <option name="wrap">true</option>
      </table>
    </panel>
  </row>
  <row>
    <panel depends="$no_wildcard_panel$">
      <title>Results - No Wildcard</title>
      <table>
        <search base="crtsh_no_wildcard_base">
          <query>| fillnull value="-" 
| search NOT "issuer ca id"="-" 
| dedup "issuer ca id" "issuer name" "name value" "min cert id" "min entry timestamp" "not before" "not after"
| table "issuer ca id" "issuer name" "name value" "min cert id" "min entry timestamp" "not before" "not after" 
| sort - "min cert id"</query>
        </search>
        <option name="count">10</option>
        <option name="drilldown">none</option>
        <option name="refresh.display">preview</option>
        <option name="rowNumbers">false</option>
        <option name="wrap">true</option>
      </table>
    </panel>
  </row>
  <row>
    <panel depends="$no_wildcard_panel$">
      <title>Results - Invalid</title>
      <table>
        <search base="crtsh_no_wildcard_base">
          <query>| dedup invalid 
| table invalid
| sort invalid</query>
        </search>
        <option name="count">10</option>
        <option name="drilldown">none</option>
        <option name="refresh.display">preview</option>
        <option name="rowNumbers">false</option>
        <option name="wrap">true</option>
      </table>
    </panel>
    <panel depends="$no_wildcard_panel$">
      <title>Results - No Data</title>
      <table>
        <search base="crtsh_no_wildcard_base">
          <query>| dedup "no data"
| table "no data"
| sort "no data"</query>
        </search>
        <option name="count">10</option>
        <option name="drilldown">none</option>
        <option name="refresh.display">preview</option>
        <option name="rowNumbers">false</option>
        <option name="wrap">true</option>
      </table>
    </panel>
  </row>
</form>